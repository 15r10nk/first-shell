import{_ as v}from"./preload-helper-41c905a7.js";function E(u={}){const{immediate:g=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:d}=u;let e,f,s;const p=async(c=!0)=>{await f,await(s==null?void 0:s())};async function w(){if("serviceWorker"in navigator){const{Workbox:c}=await v(()=>import("./workbox-window.prod.es5-295a6886.js"),[],import.meta.url);e=new c("/first-shell/sw.js",{scope:"/first-shell/",type:"classic"}),s=async()=>{await(e==null?void 0:e.messageSkipWaiting())};{let i=!1;const l=()=>{i=!0,e==null||e.addEventListener("controlling",t=>{t.isUpdate&&window.location.reload()}),r==null||r()};e.addEventListener("installed",t=>{typeof t.isUpdate>"u"?typeof t.isExternal<"u"?t.isExternal?l():!i&&(n==null||n()):t.isExternal?window.location.reload():!i&&(n==null||n()):t.isUpdate||n==null||n()}),e.addEventListener("waiting",l),e.addEventListener("externalwaiting",l)}e.register({immediate:g}).then(i=>{a?a("/first-shell/sw.js",i):o==null||o(i)}).catch(i=>{d==null||d(i)})}}return f=w(),p}export{E as registerSW};
